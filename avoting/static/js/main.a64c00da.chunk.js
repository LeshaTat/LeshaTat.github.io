(this.webpackJsonpavoting=this.webpackJsonpavoting||[]).push([[0],{187:function(e,t){},189:function(e,t){},199:function(e,t){},201:function(e,t){},228:function(e,t){},229:function(e,t){},234:function(e,t){},236:function(e,t){},243:function(e,t){},262:function(e,t){},278:function(e,t){},283:function(e,t,n){},284:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(28),s=n.n(c),i=n(14),o=n(60),u=n.n(o),d=n(8),l=n(48),f=function(){return Object(l.b)()},b=l.c,j=n(9),p=n.n(j),h=n(10),x=n(25),v=n(26),m=n(24),g=n(57),O=n(61),y=n.n(O),k=n(41);function w(){return AlgoSigner}var C="TestNet",T=n(148),A=n.n(T),S=n(49),B=String.fromCharCode,P=function(e){for(var t=[],n=0,r=e.length;n<r;n++)t.push(B(e[n]));return btoa(t.join(""))};function V(e){var t=Object(S.createHash)().update(e).digest();return t=Object(S.createHash)().update(t).digest(),P(t)}k.maxCandidates;function I(e){var t,n=(t=5,P(A.a.randomBytes(t)))+":"+e.title.replaceAll(":","")+":"+e.endRound+":"+JSON.stringify(e.scheme.candidates),r=V(e.creator+":"+n).slice(0,10);return{id:r,s:"ltavoting:"+r+":"+n}}function R(e,t){var n=t.split(":");if(n[1]!=V(e+":"+n.slice(2).join(":")).slice(0,10))return console.log("Incorrect voting description: "+e+", "+t),null;var r={creator:e,title:n[3],endRound:parseInt(n[4])||0,scheme:{candidates:[]},boosted:!1};return r.scheme.candidates=JSON.parse(n.slice(5).join(":")),r}function N(e,t,n){return"ltavote:"+e+":"+n.join(",")+":"+t}function D(e){var t=e.split(":");return{votes:t[2].split(",").map((function(e){return parseInt(e)})),mes:t.slice(3).join(":")}}var E=function(e){return new Promise((function(t){return setTimeout(t,e)}))};function L(e){return H.apply(this,arguments)}function H(){return(H=Object(h.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,w().indexer({ledger:C,path:"/v2/transactions?txid="+t}).catch((function(e){console.log("any")}));case 3:if(!((n=e.sent)&&n.transactions&&n.transactions.length)){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,E(1e3);case 8:e.next=0;break;case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t,n,r){return M.apply(this,arguments)}function M(){return(M=Object(h.a)(p.a.mark((function e(t,n,r,a){var c,s,i,o,u,d,l,f,b;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w().algod({ledger:C,path:"/v2/transactions/params"});case 2:return c=e.sent,s=c["last-round"]+a,a||(s=0),i=I({creator:t,endRound:s,title:r,scheme:n,boosted:!1}),i.id,o=i.s,u=y.a.makePaymentTxnWithSuggestedParamsFromObject({from:t,to:k.regAddress,amount:0,note:w().encoding.stringToByteArray(o),suggestedParams:{fee:c["min-fee"],firstRound:c["last-round"],lastRound:c["last-round"]+1e3,genesisHash:c["genesis-hash"],genesisID:c["genesis-id"],flatFee:!0}}),d=w().encoding.msgpackToBase64(u.toByte()),e.next=10,w().signTxn([{txn:d}]);case 10:return l=e.sent,e.next=13,w().send({ledger:C,tx:l[0].blob});case 13:if(f=e.sent,!(b=f&&f.txId)){e.next=18;break}return e.next=18,L(b);case 18:return e.abrupt("return",b);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,n,r,a,c){return _.apply(this,arguments)}function _(){return(_=Object(h.a)(p.a.mark((function e(t,n,r,a,c,s){var i,o,u,d,l,f;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w().algod({ledger:C,path:"/v2/transactions/params"});case 2:return i=e.sent,o=y.a.makePaymentTxnWithSuggestedParamsFromObject({from:t,to:r,amount:a,note:w().encoding.stringToByteArray(N(n,s,c)),suggestedParams:{fee:i["min-fee"],firstRound:i["last-round"],lastRound:i["last-round"]+1e3,genesisHash:i["genesis-hash"],genesisID:i["genesis-id"],flatFee:!0}}),u=w().encoding.msgpackToBase64(o.toByte()),e.next=7,w().signTxn([{txn:u}]);case 7:return d=e.sent,e.next=10,w().send({ledger:C,tx:d[0].blob}).catch((function(e){}));case 10:if(l=e.sent,!(f=l&&l.txId)){e.next=15;break}return e.next=15,L(f);case 15:return e.abrupt("return",i["last-round"]);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(e,t){return z.apply(this,arguments)}function z(){return(z=Object(h.a)(p.a.mark((function e(t,n){var r,a,c,s,i,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w().algod({ledger:C,path:"/v2/transactions/params"});case 2:return r=e.sent,a=y.a.makePaymentTxnWithSuggestedParamsFromObject({from:t,to:k.regAddress,amount:1e5,note:w().encoding.stringToByteArray(n),suggestedParams:{fee:r["min-fee"],firstRound:r["last-round"],lastRound:r["last-round"]+1e3,genesisHash:r["genesis-hash"],genesisID:r["genesis-id"],flatFee:!0}}),c=w().encoding.msgpackToBase64(a.toByte()),e.next=7,w().signTxn([{txn:c}]);case 7:return s=e.sent,e.next=10,w().send({ledger:C,tx:s[0].blob}).catch((function(e){}));case 10:if(i=e.sent,!(o=i&&i.txId)){e.next=15;break}return e.next=15,L(o);case 15:return e.abrupt("return",r["last-round"]);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e){return U.apply(this,arguments)}function U(){return(U=Object(h.a)(p.a.mark((function e(t){var n,r,a,c,s,i,o,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w().indexer({ledger:C,path:"/v2/accounts/"+k.regAddress+"/transactions?txid="+t});case 2:n=e.sent,console.log(n),r=null,a=Object(g.a)(n.transactions),e.prev=6,a.s();case 8:if((c=a.n()).done){e.next=17;break}if(s=c.value,i=s.sender,o=atob(s.note),!(r=R(i,o))){e.next=15;break}return e.abrupt("break",17);case 15:e.next=8;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(6),a.e(e.t0);case 22:return e.prev=22,a.f(),e.finish(22);case 25:if(!r){e.next=30;break}return e.next=28,w().indexer({ledger:C,path:"/v2/accounts/"+k.regAddress+"/transactions?currency-greater-than=99999&note-prefix="+btoa(t)});case 28:(u=e.sent)&&u.transactions&&u.transactions.length&&(r.boosted=!0);case 30:return e.abrupt("return",r);case 31:case"end":return e.stop()}}),e,null,[[6,19,22,25]])})))).apply(this,arguments)}function X(e,t,n){return Z.apply(this,arguments)}function Z(){return(Z=Object(h.a)(p.a.mark((function e(t,n,r){var a,c,s,i,o,u,d,l,f,b,j,h,x,v;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=1e3,c="",s=0,i=[];case 4:return e.next=7,w().indexer({ledger:C,path:"/v2/accounts/"+t+"/transactions?note-prefix="+btoa("ltavote:"+n+":")+(c?"&next="+c:"")});case 7:if(o=e.sent,console.log(o),o.transactions&&o.transactions.length){e.next=13;break}if(i.length){e.next=12;break}return e.abrupt("return",null);case 12:return e.abrupt("break",39);case 13:u=o.transactions.length-1;case 14:if(!(u>=0)){e.next=34;break}if(d=o.transactions[u],l=d["payment-transaction"]||{},l.receiver==r){e.next=20;break}return e.abrupt("continue",31);case 20:if(d.sender==t){e.next=22;break}return e.abrupt("continue",31);case 22:if(f=l.amount,b=atob(d.note),j=D(b)){e.next=27;break}return e.abrupt("continue",31);case 27:h=j.mes,x=j.votes,s+=f,v={round:d["confirmed-round"],votes:x.map((function(e){return Math.min(e,s)})),sum:s,mes:h},i.push(v);case 31:--u,e.next=14;break;case 34:if(c=o["next-token"],!(o.transactions.length<a)){e.next=37;break}return e.abrupt("break",39);case 37:e.next=4;break;case 39:return e.abrupt("return",i);case 40:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e,t){return Y.apply(this,arguments)}function Y(){return(Y=Object(h.a)(p.a.mark((function e(t,n){var r,a,c,s,i,o,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=1e3,a={},c={},s="";case 4:return e.next=7,w().indexer({ledger:C,path:"/v2/accounts/"+n+"/transactions?note-prefix="+btoa("ltavote:"+t+":")+(s?"&next="+s:"")});case 7:if(i=e.sent,console.log(i),i&&i.transactions){e.next=11;break}return e.abrupt("return",null);case 11:o=function(e){var t=i.transactions[e],r=t["payment-transaction"]||{},s=t.sender;if(r.receiver!=n)return"continue";var o=r.amount,u=D(atob(t.note));if(!u)return"continue";var d=c[s]||[];c[s]=d;var l=a[s]||0;l+=o,a[s]=l;var f=u.mes,b=u.votes,j={round:t["confirmed-round"],votes:b.map((function(e){return Math.min(e,l)})),sum:l,mes:f};d.push(j)},u=i.transactions.length-1;case 13:if(!(u>=0)){e.next=20;break}if("continue"!==o(u)){e.next=17;break}return e.abrupt("continue",17);case 17:--u,e.next=13;break;case 20:if(s=i["next-token"],!(i.transactions.length<r)){e.next=23;break}return e.abrupt("break",25);case 23:e.next=4;break;case 25:return e.abrupt("return",c);case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var q=Object(m.b)({name:"status",initialState:{amount:"",accounts:[],account:"",processing:!1,initialized:!1},reducers:{setAmount:function(e,t){e.initialized=!0,e.amount=t.payload.toString()},setProcessing:function(e,t){e.processing=t.payload},setAccounts:function(e,t){e.accounts=t.payload,0==e.accounts.length&&(e.initialized=!0),-1==e.accounts.findIndex((function(t){return t==e.account}))&&(e.account=e.accounts.length>0?e.accounts[0]:"")},setAccount:function(e,t){e.account=t.payload,-1==e.accounts.findIndex((function(t){return t==e.account}))&&(e.account="")}}}),Q=q.actions,$=Q.setAmount,ee=Q.setProcessing,te=Q.setAccounts,ne=Q.setAccount,re=function(e){return e.status.amount},ae=function(e){return e.status.account},ce=function(e){return e.status.initialized},se=function(e){return e.status.accounts},ie=function(e){return e.status.processing},oe=function(){return function(){var e=Object(h.a)(p.a.mark((function e(t,n){var r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=ae(n()))){e.next=6;break}return e.next=4,w().indexer({ledger:C,path:"/v2/accounts/"+r});case 4:(a=e.sent)&&a.account&&t($(a.account.amount));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},ue=function(e,t){return function(){var n=Object(h.a)(p.a.mark((function n(r,a){var c;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r(ee(!0)),n.prev=1,n.next=4,r(e);case 4:if(c=n.sent,t&&t.noStatus){n.next=8;break}return n.next=8,r(oe());case 8:return n.abrupt("return",c);case 11:throw n.prev=11,n.t0=n.catch(1),n.t0;case 14:return n.prev=14,r(ee(!1)),n.finish(14);case 17:case"end":return n.stop()}}),n,null,[[1,11,14,17]])})));return function(e,t){return n.apply(this,arguments)}}()},de=function(){return function(){var e=Object(h.a)(p.a.mark((function e(t,n){var r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(ee(!0)),e.prev=1,e.next=4,t(oe());case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),"string"==typeof e.t0?alert(e.t0):alert((null===e.t0||void 0===e.t0||null===(r=e.t0.response)||void 0===r||null===(a=r.body)||void 0===a?void 0:a.message)||"Request failed");case 9:return e.prev=9,t(ee(!1)),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[1,6,9,12]])})));return function(t,n){return e.apply(this,arguments)}}()},le=q.reducer,fe=Object(m.b)({name:"newVoting",initialState:{title:"A Voting",scheme:{candidates:["test1","test2"]},duration:3e5},reducers:{addCandidate:function(e,t){var n=[].concat(Object(v.a)(e.scheme.candidates),[""]);e.scheme=Object(x.a)(Object(x.a)({},e.scheme),{},{candidates:n})},removeCandidate:function(e,t){var n=Object(v.a)(e.scheme.candidates);n.splice(t.payload,1),e.scheme=Object(x.a)(Object(x.a)({},e.scheme),{},{candidates:n})},changeCandidate:function(e,t){var n=Object(v.a)(e.scheme.candidates);n.splice(t.payload.ind,1,t.payload.name),e.scheme=Object(x.a)(Object(x.a)({},e.scheme),{},{candidates:n})},updateNewTitle:function(e,t){e.title=t.payload}}}),be=fe.actions,je=be.addCandidate,pe=be.removeCandidate,he=be.changeCandidate,xe=be.updateNewTitle,ve=function(e){return e.newVoting.title},me=function(e){return e.newVoting.scheme},ge=fe.reducer,Oe=n(293),ye=n(294),ke=n(286),we=n(295),Ce=n(1);function Te(){var e=b(ve),t=b(me),n=f(),r=Object(d.f)();return Object(Ce.jsxs)(Oe.a,{children:[Object(Ce.jsxs)(ye.a,{children:[Object(Ce.jsx)(ye.a.Title,{children:Object(Ce.jsx)(Oe.a.Group,{controlId:"formTitle",style:{margin:10},children:Object(Ce.jsx)(Oe.a.Control,{type:"text",placeholder:"Enter title",value:e,onChange:function(e){return n(xe(e.currentTarget.value))}})})}),Object(Ce.jsxs)(ye.a.Body,{children:[t.candidates.map((function(e,t){return Object(Ce.jsxs)(ke.a,{className:"mb-3",children:[Object(Ce.jsx)(Oe.a.Control,{type:"text",placeholder:"Candidate's description",value:e,onChange:function(e){return n(he({ind:t,name:e.currentTarget.value}))}}),Object(Ce.jsx)(ke.a.Append,{children:Object(Ce.jsx)(ke.a.Text,{style:{cursor:"pointer"},onClick:function(){return n(pe(t))},children:"Remove"})})]},t)})),Object(Ce.jsx)(we.a,{variant:"primary",type:"submit",onClick:function(e){e.preventDefault(),n(je())},children:"Add candidate"})]})]}),Object(Ce.jsx)(we.a,{variant:"primary",type:"submit",style:{marginTop:20},onClick:function(a){a.preventDefault(),n(ue(function(e,t,n,r){return function(){var a=Object(h.a)(p.a.mark((function a(c,s){var i,o;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i=ae(s())){a.next=3;break}throw"Account is not loaded";case 3:return a.next=5,J(i,e,t,n);case 5:(o=a.sent)&&setTimeout((function(){return r(o)}),1);case 7:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}()}(t,e,0,(function(e){return r("/avoting/"+e)}))))},children:"Register"})]})}var Ae=n(32),Se=n.n(Ae),Be=Object(m.b)({name:"voting",initialState:{id:"",description:null,state:null},reducers:{setVotingId:function(e,t){e.id!=t.payload&&(e.id=t.payload,e.description=null,e.state=null)},setVotingDescription:function(e,t){e.description=t.payload},updateVotingState:function(e,t){e.state=t.payload}}}),Pe=Be.actions,Ve=Pe.setVotingId,Ie=Pe.setVotingDescription,Re=Pe.updateVotingState,Ne=function(e){return e.voting.id},De=function(e){return e.voting.state},Ee=function(e){return e.voting.description},Le=function(){return function(){var e=Object(h.a)(p.a.mark((function e(t,n){var r,a,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Ne(n())){e.next=3;break}throw"Voting is not loaded";case 3:return e.next=5,W(r);case 5:if(a=e.sent,t(Ie(a)),a){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,K(r,a.creator);case 11:c=e.sent,console.log(c),t(Re(c));case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},He=Be.reducer,Je=n(287),Me=n(288),Fe=n(289),_e=n(150),Ge=n(291),ze=n(21);function We(e){var t=e.id,n=b(ie),c=b(ae),s=b(De),o=b(Ee),u=b(ce),d=f(),l=Object(r.useState)(!1),j=Object(i.a)(l,2),v=j[0],m=j[1],g=Object(r.useState)(0),O=Object(i.a)(g,2),y=O[0],k=O[1],w=Object(r.useState)(0),C=Object(i.a)(w,2),T=C[0],A=(C[1],Object(r.useState)(0)),S=Object(i.a)(A,2),B=S[0],P=S[1];a.a.useEffect((function(){m(!1),d(Ve(t))}),[t]),a.a.useEffect((function(){!u||n||v||(m(!0),d(ue(Le())))}),[u,n,t]);var V=a.a.useMemo((function(){return s&&o&&function(e,t,n,r,a){var c=t.scheme.candidates.map((function(e){return 0})),s=[],i=0,o=0,u=0,d=0,l=-1,f=-1,b=0;for(var j in e){var p=e[j],h=0,x=0;p.length&&((-1==l||p[0].round<l)&&(l=p[0].round),(-1==f||p[p.length-1].round>f)&&(f=p[p.length-1].round),h=p[p.length-1].sum);for(var v=p.length-1;v>=0;--v){var m=p[v];if(!(n&&m.round>n)&&!(r&&m.round<r)){for(var g in x||(x=m.sum),a&&(x=Math.min(x,a)),m.votes)c[g]+=Math.round(m.votes[g]*(x/m.sum));break}}for(;v>=0;--v)if(!(r&&p[v].round<r)&&p[v].mes){s.push({voter:j,amount:h,mes:p[v].mes,round:p[v].round});break}h>0&&++u,x>0&&++d,i+=h,o+=x,h>b&&(b=h)}return{votes:c,messages:s,sum:i,sumCurrent:o,senders:u,sendersCurrent:d,firstRound:l,lastRound:f,maxPayment:b}}(s,o,y,T,B)}),[s,o,y,T,B]);if(!o||!V)return n?null:Object(Ce.jsx)("div",{children:"Not found"});var I=o.title,R=(o.scheme,o.boosted);return Object(Ce.jsxs)("div",{children:[Object(Ce.jsxs)(ye.a,{style:{marginBottom:10},children:[Object(Ce.jsxs)(ye.a.Title,{children:[Object(Ce.jsxs)(Je.a,{style:{float:"right"},children:[R?Object(Ce.jsx)(we.a,{variant:"success",children:"Boosted"}):Object(Ce.jsx)(we.a,{variant:"danger",onClick:function(e){e.preventDefault(),d(ue(function(){var e=Object(h.a)(p.a.mark((function e(t,n){var r,a,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=ae(n()),a=Ee(n()),r){e.next=4;break}throw"Account is not loaded";case 4:if((c=Ne(n()))&&a){e.next=7;break}throw"Voting is not loaded";case 7:if(!a.boosted){e.next=9;break}throw"Already boosted";case 9:return e.next=11,G(r,c);case 11:t(Ie(Object(x.a)(Object(x.a)({},a),{},{boosted:!0})));case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()))},children:"Boost"}),Object(Ce.jsx)(we.a,{variant:"secondary",onClick:function(e){e.preventDefault(),d(ue(Le()))},children:"Refresh"})]}),Object(Ce.jsx)("h1",{style:{margin:10},children:Object(Ce.jsx)(ze.b,{to:"/avoting/"+t,children:I})}),Object(Ce.jsx)("div",{title:o.creator,style:{color:"gray",marginLeft:20},children:"by "+o.creator.slice(0,15)+"..."})]}),Object(Ce.jsx)(ye.a.Body,{children:o.scheme.candidates.map((function(e,t){return Object(Ce.jsxs)("div",{children:[e,Object(Ce.jsx)(Se.a,{value:V.votes[t]||0,step:1,max:V.sumCurrent,min:0,bsPrefix:"range-simple",tooltipLabel:function(e){return""+e/1e6}})]},t)}))})]}),Object(Ce.jsxs)(Me.a,{children:[Object(Ce.jsxs)(Fe.a,{as:"dl",children:[Object(Ce.jsx)(_e.a,{as:"dt",children:"Total payments:"}),Object(Ce.jsx)(_e.a,{as:"dd",children:V.sum/1e6+(V.sum!=V.sumCurrent?"("+V.sumCurrent/1e6+")":"")})]}),Object(Ce.jsxs)(Fe.a,{as:"dl",children:[Object(Ce.jsx)(_e.a,{as:"dt",children:"Voters: "}),Object(Ce.jsx)(_e.a,{as:"dd",children:V.senders+(V.senders!=V.sendersCurrent?"("+V.sendersCurrent+")":"")})]})]}),c&&Object(Ce.jsx)(ze.b,{to:"/avoting/"+t+"/"+c,children:Object(Ce.jsx)(we.a,{style:{width:"30%"},children:"Vote"})}),R?Object(Ce.jsxs)(ye.a,{style:{marginTop:30,marginBottom:30},children:[Object(Ce.jsx)(ye.a.Header,{children:"Boosted features"}),Object(Ce.jsxs)(ye.a.Body,{children:[Object(Ce.jsxs)("div",{children:["Timeline",Object(Ce.jsx)(Se.a,{value:y||V.lastRound,onChange:function(e,t){return k(t)},step:1,max:V.lastRound,min:V.firstRound,bsPrefix:"range-simple"})]}),"          ",Object(Ce.jsxs)("div",{style:{marginTop:20},children:["Limit payment value",Object(Ce.jsx)(Se.a,{value:B||V.maxPayment,onChange:function(e,t){return P(t)},step:1,max:V.maxPayment,min:1,tooltipLabel:function(e){return""+e/1e6},bsPrefix:"range-simple"})]})]})]}):Object(Ce.jsx)("div",{style:{marginTop:30}}),V.messages.map((function(e,n){return Object(Ce.jsxs)(Ge.a,{children:[Object(Ce.jsxs)(Ge.a.Header,{closeButton:!1,children:[Object(Ce.jsx)("strong",{className:"mr-auto",children:Object(Ce.jsx)(ze.b,{to:"/avoting/"+t+"/"+e.voter,children:e.voter.slice(0,15)+"..."})}),Object(Ce.jsx)("small",{children:e.amount})]}),Object(Ce.jsx)(Ge.a.Body,{children:e.mes})]},n)}))]})}var Ue=n(292),Xe=n(290);function Ze(){var e=b(ie),t=b(re),n=b(ae),c=b(se),s=f();return Object(r.useEffect)((function(){w().accounts({ledger:C}).then((function(e){s(te(e.map((function(e){return e.address})))),s(de())}))}),[]),Object(Ce.jsxs)(a.a.Fragment,{children:[Object(Ce.jsx)(ye.a,{children:Object(Ce.jsxs)(ye.a.Body,{children:[Object(Ce.jsxs)(Me.a,{children:[Object(Ce.jsx)("div",{style:{marginBottom:10},children:C}),Object(Ce.jsx)(Ue.a,{style:{marginBottom:20},children:c.map((function(e,t){return Object(Ce.jsx)(Ue.a.Item,{style:n!=e?{cursor:"pointer"}:{},active:n==e,onClick:function(){s(ne(e)),s(de())},children:e.slice(0,10)+"..."},t)}))}),Object(Ce.jsxs)(Fe.a,{as:"dl",children:[Object(Ce.jsx)(_e.a,{as:"dt",children:"Amount: "}),Object(Ce.jsx)(_e.a,{as:"dd",children:""==t?"unknown":(parseInt(t)||0)/1e6})]})]}),Object(Ce.jsx)(we.a,{variant:"primary",type:"submit",onClick:function(){var e=Object(h.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,w().accounts({ledger:C});case 3:n=e.sent,s(te(n.map((function(e){return e.address})))),s(de());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:"Update"}),Object(Ce.jsx)("div",{style:{float:"right"},children:e?Object(Ce.jsx)(Xe.a,{animation:"border"}):null})]})}),Object(Ce.jsx)("div",{children:Object(Ce.jsx)(ze.b,{to:"/avoting",children:"New voting"})})]})}n(4);var Ke=Object(m.b)({name:"vote",initialState:{voter:"",voting:"",history:null},reducers:{setVoterAndVoting:function(e,t){e.voter==t.payload.voter&&e.voting==t.payload.voting||(e.history=null),e.voting=t.payload.voting,e.voter=t.payload.voter},updateHistory:function(e,t){e.history=t.payload}}}),Ye=Ke.actions,qe=Ye.setVoterAndVoting,Qe=Ye.updateHistory,$e=function(e){return e.vote.voter},et=function(e){return e.vote.voting},tt=function(e){return e.vote.history},nt=Ke.reducer,rt=n(149);function at(e){return e.scheme.candidates.map((function(e){return 0}))}function ct(){var e=Object(d.g)()||{},t=e.voter,n=e.voting,c=b(ie),s=b(ae),o=b(Ee),u=b(ce),l=b(tt),j=f(),x=Object(r.useState)(1e4),m=Object(i.a)(x,2),g=m[0],O=m[1],y=Object(r.useState)([]),k=Object(i.a)(y,2),w=k[0],C=k[1],T=Object(r.useState)([]),A=Object(i.a)(T,2),S=A[0],B=A[1],P=Object(r.useState)(""),V=Object(i.a)(P,2),I=V[0],R=V[1];a.a.useEffect((function(){B([]),C([]),O(1e4),R("")}),[t]),a.a.useEffect((function(){B([]),O(1e4),R(""),N(l)}),[s]),a.a.useEffect((function(){t&&n&&j(qe({voter:t,voting:n}))}),[t,n]);var N=function(e){C(e&&e.length?e[e.length-1].votes:[]),B(e&&e.length?e[e.length-1].votes:[]),R(function(e){if(!e)return"";for(var t=e.length-1;t>=0;--t)if(e[t].mes)return e[t].mes;return""}(e))},D=function(){return j(ue((e=N,function(){var t=Object(h.a)(p.a.mark((function t(n,r){var a,c,s,i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=$e(r()),c=et(r()),a&&c){t.next=4;break}throw"Voting or voter is not loaded";case 4:if(n(Ve(c)),s=Ee(r())){t.next=9;break}return t.next=9,Le()(n,r,null);case 9:if(s=Ee(r())){t.next=12;break}throw"Voting description is not loaded";case 12:return t.next=14,X(a,c,s.creator);case 14:i=t.sent,n(Qe(i)),e(i);case 17:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())));var e};if(a.a.useEffect((function(){t&&n&&u&&D()}),[u,t,n]),!o||!t||!n)return c?null:Object(Ce.jsx)("div",{children:"Not found"});var E=o.title,L=(o.scheme,null);l&&l.length&&(L=l[l.length-1]);var H=L&&L.sum||0;return Object(Ce.jsxs)("div",{children:[Object(Ce.jsxs)(ye.a,{children:[Object(Ce.jsxs)(ye.a.Title,{children:[Object(Ce.jsx)(we.a,{style:{float:"right"},variant:"secondary",onClick:function(e){e.preventDefault(),D()},children:"Refresh"}),Object(Ce.jsx)("h1",{style:{margin:10},children:Object(Ce.jsx)(ze.b,{to:"/avoting/"+n,children:E})}),Object(Ce.jsx)("div",{title:t,style:{color:"gray",marginLeft:20},children:"vote of "+t.slice(0,15)+"..."})]}),Object(Ce.jsx)(ye.a.Body,{children:o.scheme.candidates.map((function(e,n){return Object(Ce.jsxs)("div",{children:[e,w.length||s!=t?Object(Ce.jsx)(Se.a,{value:w[n]||0,step:1,max:H+g,min:0,disabled:!0,tooltipPlacement:"top",bsPrefix:"range-simple",tooltipLabel:function(e){return""+e/1e6}}):null,s==t&&Object(Ce.jsx)(Se.a,{value:S[n]||0,onChange:function(e,t){return B(function(e,t,n,r){return n.length||(n=at(r)),n[e]==t||((n=Object(v.a)(n))[e]=t),n}(n,t,S,o))},step:1,max:H+g,min:0,tooltipLabel:function(e){return""+e/1e6},bsPrefix:"range-simple"})]},n)}))})]}),s!=t?null:Object(Ce.jsxs)("div",{children:[Object(Ce.jsxs)(ke.a,{className:"mb-3",style:{marginTop:20},children:[Object(Ce.jsx)(ke.a.Prepend,{children:Object(Ce.jsx)(ke.a.Text,{children:H/1e6+" + "})}),Object(Ce.jsx)(Oe.a.Control,{type:"number",placeholder:"Payment",value:g/1e6,onChange:function(e){var t=1e6*parseFloat(e.currentTarget.value)||0;O(t),B(function(e,t,n,r){n.length||(n=at(r));var a=Object(v.a)(n);for(var c in a)t>0&&(a[c]+=t),a[c]=Math.max(a[c],e);return a}(H+t,t-g,S,o))}}),Object(Ce.jsx)(ke.a.Append,{children:Object(Ce.jsx)(we.a,{onClick:function(e){j(ue(function(e,t,n,r,a){return function(){var c=Object(h.a)(p.a.mark((function c(s,i){var o,u,d,l,f,b;return p.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(o=ae(i()),u=$e(i()),d=et(i()),u&&d&&u==o){c.next=5;break}throw"Voting or voter is not loaded";case 5:if(l=Ee(i())){c.next=8;break}throw"Voting description is not loaded";case 8:return c.next=10,F(o,d,l.creator,e,t,n);case 10:f=c.sent,r=Object(v.a)(r),b=0,r.length&&(b=r[r.length-1].sum),b+=e,r.push({mes:n,votes:t,sum:b,round:f}),a(r);case 17:case"end":return c.stop()}}),c)})));return function(e,t){return c.apply(this,arguments)}}()}(g,S,I,l||[],(function(){D(),O(0)}))))},children:"Send"})})]}),Object(Ce.jsx)(ke.a,{children:Object(Ce.jsx)(rt.a,{as:"textarea",value:I,placeholder:"Message",onChange:function(e){return R(e.currentTarget.value)}})})]})]})}function st(){var e=Object(d.g)();return Object(Ce.jsx)("div",{children:"List by sender "+e.sender})}function it(){var e=Object(d.g)();return Object(Ce.jsx)(We,{id:e.addr||""})}var ot=function(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],c=t[1];return a.a.useEffect((function(){setTimeout((function(){try{w()||c("error"),w().connect().then((function(){c("done")})).catch((function(){c("error")}))}catch(e){c("error")}}),500)}),[]),"done"!=n?Object(Ce.jsx)("div",{className:u.a.main,children:Object(Ce.jsx)(Me.a,{children:Object(Ce.jsx)(Fe.a,{children:Object(Ce.jsx)(_e.a,{sm:12,children:"no"==n?"Please install AlgoSigner":"error"==n&&"Please enable AlgoSigner on this page"})})})}):Object(Ce.jsx)("div",{className:u.a.main,children:Object(Ce.jsx)(Me.a,{children:Object(Ce.jsxs)(Fe.a,{children:[Object(Ce.jsx)(_e.a,{sm:3,children:Object(Ce.jsx)(Ze,{})}),Object(Ce.jsx)(_e.a,{sm:9,children:Object(Ce.jsxs)(d.c,{children:[Object(Ce.jsx)(d.a,{path:"avoting/",element:Object(Ce.jsx)(Te,{})}),Object(Ce.jsx)(d.a,{path:"avoting/list/:sender",element:Object(Ce.jsx)(st,{})}),Object(Ce.jsx)(d.a,{path:"avoting/vote/:addr",element:Object(Ce.jsx)(it,{})}),Object(Ce.jsx)(d.a,{path:"avoting/:voting/:voter",element:Object(Ce.jsx)(ct,{})}),Object(Ce.jsx)(d.a,{path:"avoting/:addr",element:Object(Ce.jsx)(it,{})})]})})]})})})},ut=Object(m.a)({reducer:{status:le,newVoting:ge,voting:He,vote:nt}});n(281),n(282),n(283);s.a.render(Object(Ce.jsx)(ze.a,{children:Object(Ce.jsx)(l.a,{store:ut,children:Object(Ce.jsx)(ot,{})})}),document.getElementById("root"))},41:function(e){e.exports=JSON.parse('{"maxCandidates":15,"regAddress":"CIJ2QXGO5LZIJLTYUEICVX42MZY7DBJKXRGMHKOOSLGWPJLLREOVJDUEVA"}')},60:function(e,t,n){e.exports={main:"App_main__3ZkGI",tabBase:"App_tabBase__3Ir4k"}}},[[284,1,2]]]);
//# sourceMappingURL=main.a64c00da.chunk.js.map